"{\"title\": \"CodeSOD: Classic WTF: Injection Proof'd\", \"source_id\": 18672, \"content\": \"Founder, The Daily WTF It's Thanksgiving, in the US. Be thankful you're not supporting this block of code. --Remy \\n\\u201cWhen a \\u2018customer\\u2019 of ours needs custom-developed software to suit their business requirements,\\u201d Kelly Adams writes, \\u201cthey can either \\u2018buy\\u2019 the development services from the IT department, or go to an outside vendor. In the latter case, then we\\u2019re supposed to approve that the software meets corporate security guidelines.\\u201d \\n\\u201cMost of the time, our \\u2018approval\\u2019 is treated as a recommendation, and we end up having to install the application anyway. But recently, they actually listened to us and told the vendor to fix the \\u2018blatant SQL-injection vulnerabilities\\u2019 that we discovered. A few weeks later, when it came time for our second review, we noticed the following as their \\u2018fix\\u2019.\\u201d internal static string FQ(string WhichField) { string expression = \\\"\\\"; int num2 = Strings.Len(WhichField); for (int i = 1; i <= num2; i++) { string str = Strings.Mid(WhichField, i, 1); if (str == \\\"'\\\") { str = str + \\\"'\\\"; } expression = expression + str; } return Strings.Trim( Strings.Replace(Strings.Replace(Strings.Replace(Strings.Replace( Strings.Replace(Strings.Replace(Strings.Replace(Strings.Replace( Strings.Replace(Strings.Replace(Strings.Replace(Strings.Replace( Strings.Replace(Strings.Replace(Strings.Replace(Strings.Replace( Strings.Replace(Strings.Replace(Strings.Replace(Strings.Replace( Strings.Replace(Strings.Replace(Strings.Replace(Strings.Replace( expression, \\\"xp_\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"sp_\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"--\\\", \\\"-\\\", 1, -1, CompareMethod.Binary), \\\"alter table\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"drop table\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"create table\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"create database\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"alter table\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"alter column\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"drop column\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"drop database\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"1=1\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"union select\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"/*\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"*/\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"boot.ini\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"../\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"%27\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\";dir\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"|dir\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"<script\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"</script>\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"language=javascript\\\", \\\"\\\", 1, -1, CompareMethod.Text), \\\"language=\\\\\\\"javascript\\\\\\\"\\\", \\\"\\\", 1, -1, CompareMethod.Text)); } \\nKelly adds, \\u201cof course this time, when we told them the application was still vulnerable so long that a hacker typed \\u20181 = 1\\u2019 instead of \\u20181=1\\u2019, they told us were beeing too picky, and had us install the application anyway.\\u201d [Advertisement] Manage IT infrastructure as code across all environments with Puppet . Puppet Enterprise now offers more control and insight, with role-based access control, activity logging and all-new Puppet Apps. Start your free trial today!\", \"article_id\": 333235}"